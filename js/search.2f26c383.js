(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["search"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"13d5":function(e,t,n){"use strict";var r=n("23e7"),a=n("d58f").left,l=n("a640"),i=n("ae40"),c=n("2d00"),o=n("605d"),u=l("reduce"),d=i("reduce",{1:0}),s=!o&&c>79&&c<83;r({target:"Array",proto:!0,forced:!u||!d||s},{reduce:function(e){return a(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(e,t,n){var r=n("c6b6"),a=n("9263");e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var l=n.call(e,t);if("object"!==typeof l)throw TypeError("RegExp exec method returned something other than an Object or null");return l}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return a.call(e,t)}},"2d3b":function(e,t,n){"use strict";n.r(t);n("99af"),n("d3b7"),n("ac1f"),n("841c"),n("ddb0");var r=n("7a23"),a=Object(r["T"])("data-v-451bf1a6");Object(r["z"])("data-v-451bf1a6");var l={class:"search"},i=Object(r["m"])("h1",null,"Search",-1),c={class:"intro"},o=Object(r["l"])(" Search could be performed using either CMIS or the API, but to use facets "),u=Object(r["m"])("a",{href:"https://developers.preservica.com/api-reference/8-content-api"},"the Content API",-1),d=Object(r["l"])(" is used. The available fields and filters are retrieved from "),s=Object(r["l"])("the indexed fields"),f=Object(r["l"])(". "),b=Object(r["m"])("p",{class:"intro p-mb-6"}," Select the fields to include in the results. All selected fields will also be available as filters. ",-1),p=Object(r["m"])("p",{class:"intro p-mb-6"}," This is the request that will be sent to the API. You can edit this manually, and it will also be updated when making changes in the other tabs and input fields. ",-1),m={class:"p-fluid p-formgrid p-grid p-text-left"},h={class:"p-field p-col-12"},v=Object(r["m"])("label",{for:"metadata"},"Metadata to return",-1),O={class:"p-field p-col-12"},j=Object(r["m"])("label",{for:"query"},"Query",-1),y={key:0,class:"p-mx-lg-6 p-mx-md-2 p-mx-sm-0"},x=Object(r["m"])("br",null,null,-1),g={class:"p-fluid p-formgrid p-grid p-text-left"},w={class:"p-input-icon-right p-mb-2"},E={class:"p-fluid p-formgrid p-grid p-text-left"},S={class:"p-field p-col-12 p-lg-8 p-md-6"},I=Object(r["m"])("label",{for:"q"},"Search text",-1),q={class:"p-field p-col-6 p-lg-1 p-md-2"},R=Object(r["m"])("label",{for:"start"},"Start",-1),_={class:"p-field p-col-6 p-lg-1 p-md-2"},T=Object(r["m"])("label",{for:"max"},"Limit",-1),C={class:"p-field p-col-12 p-lg-2 p-md-2 p-as-end"},k={key:1},V={class:"json"};Object(r["x"])();var A=a((function(e,t,n,A,M,N){var B,U=Object(r["E"])("router-link"),P=Object(r["E"])("TabPanel"),F=Object(r["E"])("Column"),J=Object(r["E"])("DataTable"),K=Object(r["E"])("InputText"),D=Object(r["E"])("Textarea"),L=Object(r["E"])("TabView"),$=Object(r["E"])("AuthWarning"),W=Object(r["E"])("Button"),Y=Object(r["E"])("InputNumber"),z=Object(r["E"])("AccordionTab"),G=Object(r["E"])("Accordion");return Object(r["w"])(),Object(r["h"])(r["a"],null,[Object(r["m"])("div",l,[i,e.configured?(Object(r["w"])(),Object(r["h"])(L,{key:0,onTabChange:e.onTabChange},{default:a((function(){return[Object(r["m"])(P,{header:"Introduction"},{default:a((function(){return[Object(r["m"])("p",c,[o,u,d,Object(r["m"])(U,{to:"/indexes"},{default:a((function(){return[s]})),_:1}),f])]})),_:1}),Object(r["m"])(P,{header:"Fields"},{default:a((function(){return[b,e.fields?(Object(r["w"])(),Object(r["h"])(J,{key:0,value:e.fields,selection:e.selectedFields,"onUpdate:selection":t[1]||(t[1]=function(t){return e.selectedFields=t}),autoLayout:!0,responsiveLayout:"scroll",sortMode:"multiple",multiSortMeta:e.multiSortMeta,filters:e.filters},{default:a((function(){return[Object(r["m"])(F,{selectionMode:"multiple",headerStyle:"width: 3rem"}),Object(r["m"])(F,{field:"shortName",header:"source",sortable:!0,filterMatchMode:"contains",headerClass:"p-text-center",bodyClass:"p-text-center"}),Object(r["m"])(F,{field:"displayName",header:"name",sortable:!0,filterMatchMode:"contains"}),Object(r["m"])(F,{field:"shortKey",header:"key",sortable:!0,filterMatchMode:"contains"}),Object(r["m"])(F,{field:"type",header:"type",sortable:!0,filterMatchMode:"in"}),Object(r["m"])(F,{field:"facetable",header:"facet",sortable:!0,filterMatchMode:"equals"})]})),_:1},8,["value","selection","multiSortMeta","filters"])):Object(r["i"])("",!0)]})),_:1}),Object(r["m"])(P,{header:"Request"},{default:a((function(){return[p,Object(r["m"])("div",null,[Object(r["m"])("div",m,[Object(r["m"])("div",h,[v,Object(r["m"])(K,{id:"metadata",type:"text",modelValue:e.metadata,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.metadata=t})},null,8,["modelValue"])]),Object(r["m"])("div",O,[j,Object(r["m"])(D,{id:"query",modelValue:e.queryJson,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.queryJson=t}),rows:"30",autoResize:!1,spellcheck:"false"},null,8,["modelValue"])])])])]})),_:1})]})),_:1},8,["onTabChange"])):Object(r["i"])("",!0),Object(r["m"])($)]),e.configured?(Object(r["w"])(),Object(r["h"])("div",y,[x,Object(r["m"])("div",g,[(Object(r["w"])(!0),Object(r["h"])(r["a"],null,Object(r["C"])(e.filtersAndValues,(function(t,n){return Object(r["w"])(),Object(r["h"])("div",{key:"field-".concat(n),class:"p-field p-col-12 p-lg-4 p-md-6"},[Object(r["m"])("label",{for:"f-".concat(n,"-0")},"Filter for "+Object(r["I"])(e.filterName(t)),9,["for"]),Object(r["m"])(W,{icon:"pi pi-plus",class:"p-button-rounded p-button-primary p-button-text",onClick:function(n){return e.addFilter(t)}},null,8,["onClick"]),(Object(r["w"])(!0),Object(r["h"])(r["a"],null,Object(r["C"])(t.values,(function(a,l){return Object(r["w"])(),Object(r["h"])("div",{key:"filter-".concat(n,"-").concat(l)},[Object(r["m"])("span",w,[Object(r["m"])(K,{id:"f-".concat(n,"-").concat(l),modelValue:t.values[l],"onUpdate:modelValue":function(e){return t.values[l]=e}},null,8,["id","modelValue","onUpdate:modelValue"]),Object(r["m"])("i",{class:"pi pi-times remove-filter",onClick:function(n){return e.removeFilter(t,l)}},null,8,["onClick"])])])})),128))])})),128))]),Object(r["m"])("div",E,[Object(r["m"])("div",S,[I,Object(r["m"])(K,{id:"q",modelValue:e.q,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.q=t})},null,8,["modelValue"])]),Object(r["m"])("div",q,[R,Object(r["m"])(Y,{id:"start",modelValue:e.start,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.start=t}),min:0,showButtons:""},null,8,["modelValue"])]),Object(r["m"])("div",_,[T,Object(r["m"])(Y,{id:"max",modelValue:e.max,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.max=t}),min:0,showButtons:""},null,8,["modelValue"])]),Object(r["m"])("div",C,[Object(r["m"])(W,{icon:"pi pi-search",onClick:e.search,label:"Search"},null,8,["onClick"])])])])):Object(r["i"])("",!0),e.result?(Object(r["w"])(),Object(r["h"])("div",k,[Object(r["m"])("h2",null,"Showing "+Object(r["I"])(null===(B=e.result.value.objectIds)||void 0===B?void 0:B.length)+" of "+Object(r["I"])(e.result.value.totalHits)+" results",1),Object(r["m"])(G,{activeIndex:0},{default:a((function(){return[Object(r["m"])(z,{header:"Table"},{default:a((function(){return[Object(r["m"])(J,{value:e.tableResults,autoLayout:!0,responsiveLayout:"scroll"},{default:a((function(){return[(Object(r["w"])(!0),Object(r["h"])(r["a"],null,Object(r["C"])(e.tableColumns,(function(e){return Object(r["w"])(),Object(r["h"])(F,{field:e.field,header:e.header,key:e.field},{body:a((function(t){return[Object(r["l"])(Object(r["I"])(t.data[e.field]),1)]})),_:2},1032,["field","header"])})),128))]})),_:1},8,["value"])]})),_:1}),Object(r["m"])(z,{header:"JSON"},{default:a((function(){return[Object(r["m"])("div",V,Object(r["I"])(e.result),1)]})),_:1})]})),_:1})])):Object(r["i"])("",!0)],64)}));n("7db0"),n("a15b"),n("d81d"),n("13d5"),n("a434"),n("b0c0"),n("a4d3"),n("e01a"),n("d28b"),n("3ca3");function M(e){return M="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}var N=n("b85c"),B=(n("96cf"),n("1da1")),U=n("18cb"),P=n("34f5"),F=n("d0f2"),J=Object(r["n"])({components:{AuthWarning:P["a"]},setup:function(){var e=Object(F["b"])(),t=e.configured,n=e.fetchWithToken,a=Object(U["b"])(),l=Object(r["B"])(void 0),i=Object(r["B"])([]),c=Object(r["B"])([]),o=Object(r["B"])([]),u=Object(r["B"])({}),d=Object(r["B"])([{field:"shortName",order:-1},{field:"displayName",order:1}]),s=Object(r["B"])(void 0),f=Object(r["B"])(0),b=Object(r["B"])(10),p=Object(r["B"])({q:"",fields:[{name:"xip.title",values:[""]},{name:"xip.description",values:[""]},{name:"xip.document_type",values:["IO"]}],sort:[{sortFields:["xip.created"],sortOrder:"desc"}],facets:["xip.created","xip.format_group_r_Display"],"facet.xip.created.range":[["*","","Pre 2015"],["2015-01-01","","2015"],["2016-01-01","","2016"],["2017-01-01","","2017"],["2018-01-01","","2018"],["2019-01-01","","2019"],["2020-01-01","","2020"],["2021-01-01","*","2021 and later"]]}),m=Object(r["B"])("xip.created,xip.title,xip.document_type,xip.format_group_r_Display"),h=function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s.value=void 0,t="q=".concat(JSON.stringify(p.value),"&start=").concat(f.value,"&max=").concat(b.value,"&metadata=").concat(m.value),e.next=4,n("api/content/search",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});case 4:return r=e.sent,e.next=7,r.json();case 7:s.value=e.sent;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t.value&&n("api/content/indexed-fields").then(function(){var e=Object(B["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:l.value=e.sent.value;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),{configured:t,toast:a,fields:l,selectedFields:i,filters:u,multiSortMeta:d,shortNames:c,types:o,query:p,start:f,max:b,metadata:m,search:h,result:s}},watch:{selectedFields:function(e){var t=this;console.log("watch selectedField"),this.query.fields=e.map((function(e){var n;return{name:e.shortKey,values:(null===(n=t.query.fields.find((function(t){return t.name===e.shortKey})))||void 0===n?void 0:n.values)||[]}})),this.metadata=this.query.fields.map((function(e){return e.name})).join()},query:function(e){this.q=e.q}},methods:{onTabChange:function(e){var t=this;if(console.log("tab change",e),this.fields&&this.query){var n,r=[],a=Object(N["a"])(this.query.fields);try{var l=function(){var e=n.value,a=t.fields.find((function(t){return e.name===t.shortKey}));if(!a)return t.toast.add({severity:"error",summary:"Invalid field",detail:"The field ".concat(e.name," in the JSON is invalid and will be removed when making other changes"),life:5e3}),{v:void 0};r.push(a)};for(a.s();!(n=a.n()).done;){var i=l();if("object"===M(i))return i.v}}catch(c){a.e(c)}finally{a.f()}this.selectedFields=r}},filterName:function(e){var t,n;return(null===(t=this.fields)||void 0===t||null===(n=t.find((function(t){return t.shortKey===e.name})))||void 0===n?void 0:n.displayName)||e.name},addFilter:function(e){var t;console.log("addfilter",e.name),null===(t=e.values)||void 0===t||t.push("")},removeFilter:function(e,t){var n;null===(n=e.values)||void 0===n||n.splice(t,1)}},computed:{queryJson:{get:function(){return JSON.stringify(this.query,null,2)},set:function(e){this.query=JSON.parse(e)}},q:{get:function(){return this.query.q},set:function(e){this.query.q=e}},filtersAndValues:{get:function(){return this.query.fields},set:function(e){this.query.fields=e}},tableResults:function(){var e,t=null===(e=this.result)||void 0===e?void 0:e.value.metadata.map((function(e){return e.reduce((function(e,t){return e[t.name]=t.value,e}),{})}));return console.log(t),console.log(t[0]["xip.created"]),t},tableColumns:function(){var e,t,n=this;return null===(e=this.result)||void 0===e||null===(t=e.value.metadata[0])||void 0===t?void 0:t.reduce((function(e,t){var r,a;return e.push({field:t.name,header:(null===(r=n.fields)||void 0===r||null===(a=r.find((function(e){return e.shortKey===t.name})))||void 0===a?void 0:a.displayName)||t.name}),e}),[])}}});n("3f6f");J.render=A,J.__scopeId="data-v-451bf1a6";t["default"]=J},"3f6f":function(e,t,n){"use strict";n("759e")},"759e":function(e,t,n){},"7db0":function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").find,l=n("44d2"),i=n("ae40"),c="find",o=!0,u=i(c);c in[]&&Array(1)[c]((function(){o=!1})),r({target:"Array",proto:!0,forced:o||!u},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),l(c)},"841c":function(e,t,n){"use strict";var r=n("d784"),a=n("825a"),l=n("1d80"),i=n("129f"),c=n("14c3");r("search",1,(function(e,t,n){return[function(t){var n=l(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var l=a(e),o=String(this),u=l.lastIndex;i(u,0)||(l.lastIndex=0);var d=c(l,o);return i(l.lastIndex,u)||(l.lastIndex=u),null===d?-1:d.index}]}))},9263:function(e,t,n){"use strict";var r=n("ad6d"),a=n("9f7f"),l=RegExp.prototype.exec,i=String.prototype.replace,c=l,o=function(){var e=/a/,t=/b*/g;return l.call(e,"a"),l.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),u=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1],s=o||d||u;s&&(c=function(e){var t,n,a,c,s=this,f=u&&s.sticky,b=r.call(s),p=s.source,m=0,h=e;return f&&(b=b.replace("y",""),-1===b.indexOf("g")&&(b+="g"),h=String(e).slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==e[s.lastIndex-1])&&(p="(?: "+p+")",h=" "+h,m++),n=new RegExp("^(?:"+p+")",b)),d&&(n=new RegExp("^"+p+"$(?!\\s)",b)),o&&(t=s.lastIndex),a=l.call(f?n:s,h),f?a?(a.input=a.input.slice(m),a[0]=a[0].slice(m),a.index=s.lastIndex,s.lastIndex+=a[0].length):s.lastIndex=0:o&&a&&(s.lastIndex=s.global?a.index+a[0].length:t),d&&a&&a.length>1&&i.call(a[0],n,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(a[c]=void 0)})),a}),e.exports=c},"9f7f":function(e,t,n){"use strict";var r=n("d039");function a(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=a("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=a("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a434:function(e,t,n){"use strict";var r=n("23e7"),a=n("23cb"),l=n("a691"),i=n("50c4"),c=n("7b0b"),o=n("65f0"),u=n("8418"),d=n("1dde"),s=n("ae40"),f=d("splice"),b=s("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,m=Math.min,h=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f||!b},{splice:function(e,t){var n,r,d,s,f,b,O=c(this),j=i(O.length),y=a(e,j),x=arguments.length;if(0===x?n=r=0:1===x?(n=0,r=j-y):(n=x-2,r=m(p(l(t),0),j-y)),j+n-r>h)throw TypeError(v);for(d=o(O,r),s=0;s<r;s++)f=y+s,f in O&&u(d,s,O[f]);if(d.length=r,n<r){for(s=y;s<j-r;s++)f=s+r,b=s+n,f in O?O[b]=O[f]:delete O[b];for(s=j;s>j-r+n;s--)delete O[s-1]}else if(n>r)for(s=j-r;s>y;s--)f=s+r-1,b=s+n-1,f in O?O[b]=O[f]:delete O[b];for(s=0;s<n;s++)O[s+y]=arguments[s+2];return O.length=j-r+n,d}})},ac1f:function(e,t,n){"use strict";var r=n("23e7"),a=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==a},{exec:a})},d58f:function(e,t,n){var r=n("1c0b"),a=n("7b0b"),l=n("44ad"),i=n("50c4"),c=function(e){return function(t,n,c,o){r(n);var u=a(t),d=l(u),s=i(u.length),f=e?s-1:0,b=e?-1:1;if(c<2)while(1){if(f in d){o=d[f],f+=b;break}if(f+=b,e?f<0:s<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?f>=0:s>f;f+=b)f in d&&(o=n(o,d[f],f,u));return o}};e.exports={left:c(!1),right:c(!0)}},d784:function(e,t,n){"use strict";n("ac1f");var r=n("6eeb"),a=n("d039"),l=n("b622"),i=n("9263"),c=n("9112"),o=l("species"),u=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){return"$0"==="a".replace(/./,"$0")}(),s=l("replace"),f=function(){return!!/./[s]&&""===/./[s]("a","$0")}(),b=!a((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,s){var p=l(e),m=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),h=m&&!a((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[o]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!m||!h||"replace"===e&&(!u||!d||f)||"split"===e&&!b){var v=/./[p],O=n(p,""[e],(function(e,t,n,r,a){return t.exec===i?m&&!a?{done:!0,value:v.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:d,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),j=O[0],y=O[1];r(String.prototype,e,j),r(RegExp.prototype,p,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}s&&c(RegExp.prototype[p],"sham",!0)}},d81d:function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").map,l=n("1dde"),i=n("ae40"),c=l("map"),o=i("map");r({target:"Array",proto:!0,forced:!c||!o},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=search.2f26c383.js.map