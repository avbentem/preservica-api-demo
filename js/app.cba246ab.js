(function(e){function t(t){for(var r,o,i=t[0],u=t[1],s=t[2],l=0,d=[];l<i.length;l++)o=i[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);p&&p(t);while(d.length)d.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==a[i]&&(r=!1)}r&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},o={app:0},a={app:0},c=[];function i(e){return u.p+"js/"+({curl:"curl",indexes:"indexes","oai-pmh":"oai-pmh",search:"search"}[e]||e)+"."+{curl:"03dbc39e",indexes:"71823ca1","oai-pmh":"c5288c7f",search:"a4d1e2eb"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={search:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=new Promise((function(t,n){for(var r="css/"+({curl:"curl",indexes:"indexes","oai-pmh":"oai-pmh",search:"search"}[e]||e)+"."+{curl:"31d6cfe0",indexes:"31d6cfe0","oai-pmh":"31d6cfe0",search:"a9c1d380"}[e]+".css",a=u.p+r,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var s=c[i],l=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(l===r||l===a))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){s=d[i],l=s.getAttribute("data-href");if(l===r||l===a)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var r=t&&t.target&&t.target.src||a,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=r,delete o[e],p.parentNode.removeChild(p),n(c)},p.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){o[e]=0})));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var c=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=c);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=i(e);var d=new Error;s=function(t){l.onerror=l.onload=null,clearTimeout(p);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",d.name="ChunkLoadError",d.type=r,d.request=o,n[1](d)}a[e]=void 0}};var p=setTimeout((function(){s({type:"timeout",target:l})}),12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/preservica-api-demo/",u.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var p=l;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"34f5":function(e,t,n){"use strict";var r=n("7a23"),o={key:0},a=Object(r["createTextVNode"])(" You need to "),c=Object(r["createTextVNode"])("configure this demo"),i=Object(r["createTextVNode"])(" to access your data. ");function u(e,t,n,u,s,l){var d=Object(r["resolveComponent"])("router-link");return e.configured?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])("p",o,[a,Object(r["createVNode"])(d,{to:"/config"},{default:Object(r["withCtx"])((function(){return[c]})),_:1}),i]))}var s=n("d0f2"),l=Object(r["defineComponent"])({setup:function(){var e=Object(s["b"])(),t=e.configured;return{configured:t}}});l.render=u;t["a"]=l},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o=n("a7bd"),a=n.n(o),c=n("51e4"),i=n.n(c),u=n("6549"),s=n.n(u),l=n("f1d0"),d=n.n(l),p=n("c524"),f=n.n(p),b=n("3ac1"),h=n.n(b),m=n("23a5"),v=n.n(m),O=n("404c"),j=n.n(O),g=n("a84a"),x=n.n(g),y=n("86b0"),w=n.n(y),V=n("b51d"),k=n.n(V),N=n("65d1"),T=n.n(N),C=n("050f"),P=n.n(C),A=n("6060"),S=n.n(A),B=n("8459"),I=n.n(B),R=n("40f3"),D=n.n(R),_={id:"nav"},U=Object(r["createTextVNode"])("home"),E=Object(r["createTextVNode"])(" | "),L=Object(r["createTextVNode"])("configuration"),z=Object(r["createTextVNode"])(" | "),F=Object(r["createTextVNode"])("indexed fields"),H=Object(r["createTextVNode"])(" | "),W=Object(r["createTextVNode"])("search"),M=Object(r["createTextVNode"])(" | "),q=Object(r["createTextVNode"])("oai-pmh"),G=Object(r["createTextVNode"])(" | "),J=Object(r["createTextVNode"])("curl");function K(e,t,n,o,a,c){var i=Object(r["resolveComponent"])("router-link"),u=Object(r["resolveComponent"])("router-view"),s=Object(r["resolveComponent"])("Toast");return Object(r["openBlock"])(),Object(r["createBlock"])(r["Fragment"],null,[Object(r["createVNode"])("div",_,[Object(r["createVNode"])(i,{to:"/"},{default:Object(r["withCtx"])((function(){return[U]})),_:1}),E,Object(r["createVNode"])(i,{to:"/config"},{default:Object(r["withCtx"])((function(){return[L]})),_:1}),z,Object(r["createVNode"])(i,{to:"/indexes"},{default:Object(r["withCtx"])((function(){return[F]})),_:1}),H,Object(r["createVNode"])(i,{to:"/search"},{default:Object(r["withCtx"])((function(){return[W]})),_:1}),M,Object(r["createVNode"])(i,{to:"/oai-pmh"},{default:Object(r["withCtx"])((function(){return[q]})),_:1}),G,Object(r["createVNode"])(i,{to:"/curl"},{default:Object(r["withCtx"])((function(){return[J]})),_:1})]),Object(r["createVNode"])(u,{id:"view"},{default:Object(r["withCtx"])((function(e){var t=e.Component;return[(Object(r["openBlock"])(),Object(r["createBlock"])(r["KeepAlive"],null,[(Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(t)))],1024))]})),_:1}),Object(r["createVNode"])(s)],64)}var Y=n("d0f2"),X={setup:function(){Object(Y["a"])()}};n("da24");X.render=K;var Q=X,Z=(n("d3b7"),n("6c02")),$={class:"home intro"},ee=Object(r["createVNode"])("h1",null,"Preservica APIs demo",-1),te=Object(r["createVNode"])("p",null,[Object(r["createTextVNode"])(" This is a (work in progress) kitchen sink showing various usage examples for some of "),Object(r["createVNode"])("a",{href:"https://developers.preservica.com/api-reference"},"the Preservica APIs.")],-1),ne=Object(r["createVNode"])("p",null,"This application runs in your browser.",-1);function re(e,t,n,o,a,c){var i=Object(r["resolveComponent"])("AuthWarning");return Object(r["openBlock"])(),Object(r["createBlock"])("div",$,[ee,te,ne,Object(r["createVNode"])(i)])}var oe=n("34f5"),ae=Object(r["defineComponent"])({name:"Home",components:{AuthWarning:oe["a"]}});ae.render=re;var ce=ae,ie={class:"configuration intro"},ue=Object(r["createVNode"])("h1",null,"Configuration",-1),se={key:0},le={key:1},de=Object(r["createVNode"])("p",null,"The Preservica APIs needs authorization, even for anonymous access.",-1),pe=Object(r["createVNode"])("p",null,[Object(r["createTextVNode"])(" When logged in to Preservica SaaS, the session cookie "),Object(r["createVNode"])("a",{href:"https://eu.preservica.com/OAI-PMH/?verb=Identify"},"will be used"),Object(r["createTextVNode"])(" when accessing the APIs in a browser directly. But for most use cases, a successful login on "),Object(r["createVNode"])("a",{href:"https://developers.preservica.com/api-reference/6-access-token-api"},"the Access Token API"),Object(r["createTextVNode"])(" is required and yields an access token and a refresh token. An access token is valid for 15 minutes and can be used in an HTTP header. However, the refresh token is valid for the same short period as the access token (and can only be used once), so is only useful when continuously accessing the API. In this demo the refresh token is ignored, and instead a new login is performed whenever the access token has expired. ")],-1),fe=Object(r["createVNode"])("p",null," A token can also be generated through the externally authenticated acquisition API. This allows a trusted external application to acquire Preservica access rights without being authenticated by Preservica. See the documentation linked above. ",-1),be=Object(r["createVNode"])("p",null,[Object(r["createVNode"])("s",null,[Object(r["createTextVNode"])("The resulting access token can also (for a short time) be used in "),Object(r["createVNode"])("a",{href:"https://eu.preservica.com/api/content/documentation.html"},"the Swagger UI interface"),Object(r["createTextVNode"])(" (adjust URL to match your SaaS domain).")])],-1);function he(e,t,n,o,a,c){var i=Object(r["resolveComponent"])("ConfigInput");return Object(r["openBlock"])(),Object(r["createBlock"])("div",ie,[ue,Object(r["createVNode"])(i),e.configured?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])("h2",se,'Please complete the form and hit "Save" or "Log in"')),e.authorized?(Object(r["openBlock"])(),Object(r["createBlock"])("h2",le,"Welcome, "+Object(r["toDisplayString"])(e.user.fullName),1)):Object(r["createCommentVNode"])("",!0),de,pe,fe,be])}var me={class:"configinput"},ve=Object(r["createVNode"])("h2",null,"Server and credentials",-1),Oe={class:"p-fluid p-formgrid p-grid p-text-left"},je={class:"p-field p-col-12"},ge=Object(r["createVNode"])("label",{for:"proxy"},"CORS proxy",-1),xe=Object(r["createVNode"])("small",{id:"proxy-help"},[Object(r["createTextVNode"])(" This demo runs in your browser, but the Preservica APIs do not support "),Object(r["createVNode"])("a",{href:"https://developer.mozilla.org/docs/Web/HTTP/CORS"},"CORS"),Object(r["createTextVNode"])(". A proxy server can add CORS headers to use a browser on a different domain. The full API URL will be appended without any encoding. "),Object(r["createVNode"])("strong",null,"A third-party proxy may log your credentials.")],-1),ye={class:"p-field p-col-12"},we=Object(r["createVNode"])("label",{for:"host"},"API host",-1),Ve={class:"p-field p-col-12 p-md-3"},ke=Object(r["createVNode"])("label",{for:"tenant"},"Tenant",-1),Ne={class:"p-field p-col-12 p-md-5"},Te=Object(r["createVNode"])("label",{for:"username"},"Username",-1),Ce={class:"p-field p-col-12 p-md-4"},Pe=Object(r["createVNode"])("label",{for:"password"},"Password",-1),Ae=Object(r["createTextVNode"])("   "),Se=Object(r["createTextVNode"])("   ");function Be(e,t,n,o,a,c){var i=Object(r["resolveComponent"])("InputText"),u=Object(r["resolveComponent"])("Button"),s=Object(r["resolveDirective"])("tooltip");return Object(r["openBlock"])(),Object(r["createBlock"])("div",me,[ve,Object(r["createVNode"])("div",Oe,[Object(r["createVNode"])("div",je,[ge,Object(r["createVNode"])(i,{id:"proxy",type:"text",modelValue:e.config.proxy,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.config.proxy=t}),"aria-describedby":"proxy-help"},null,8,["modelValue"]),xe]),Object(r["createVNode"])("div",ye,[we,Object(r["createVNode"])(i,{id:"host",type:"text",modelValue:e.config.host,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.config.host=t})},null,8,["modelValue"])]),Object(r["createVNode"])("div",Ve,[ke,Object(r["createVNode"])(i,{id:"tenant",type:"text",modelValue:e.config.tenant,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.config.tenant=t})},null,8,["modelValue"])]),Object(r["createVNode"])("div",Ne,[Te,Object(r["createVNode"])(i,{id:"username",type:"text",modelValue:e.config.username,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.config.username=t})},null,8,["modelValue"])]),Object(r["createVNode"])("div",Ce,[Pe,Object(r["createVNode"])(i,{id:"password",type:"password",modelValue:e.config.password,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.config.password=t})},null,8,["modelValue"])])]),Object(r["withDirectives"])(Object(r["createVNode"])(u,{icon:"pi pi-save",onClick:e.save,label:"Save"},null,8,["onClick"]),[[s,"Set the configuration, but do not log in yet",void 0,{top:!0}]]),Ae,Object(r["withDirectives"])(Object(r["createVNode"])(u,{icon:"pi pi-user",onClick:e.login,label:"Log in"},null,8,["onClick"]),[[s,"Set the configuration and log in",void 0,{top:!0}]]),Se,Object(r["withDirectives"])(Object(r["createVNode"])(u,{icon:"pi pi-lock",onClick:e.getToken,label:"Get token"},null,8,["onClick"]),[[s,"Show the current token, or refresh if needed",void 0,{top:!0}]])])}n("96cf");var Ie=n("1da1"),Re=n("5502"),De=n("d36f"),_e=Object(r["defineComponent"])({setup:function(){var e=Object(De["useToast"])(),t=Object(Re["b"])(),n=Object(Y["b"])(),o=Object(r["ref"])(t.state.config),a=function(){var t=Object(Ie["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.setConfig(o.value),e.add({severity:"info",summary:"Saved config",detail:"But not logging in yet",life:3e3});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=function(){var t=Object(Ie["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.add({severity:"info",summary:"Logging in",detail:o.value.username,life:3e3}),t.next=3,n.login(o.value);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),i=function(){var t=Object(Ie["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.getToken();case 2:r=t.sent,e.add({severity:"info",summary:"Token",detail:r});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{config:o,save:a,login:c,getToken:i}}});_e.render=Be;var Ue=_e,Ee=Object(r["defineComponent"])({setup:function(){var e=Object(Y["b"])(),t=e.configured,n=e.authorized,r=e.user;return{configured:t,authorized:n,user:r}},components:{ConfigInput:Ue}});Ee.render=he;var Le=Ee,ze=[{path:"/",name:"Home",component:ce},{path:"/config",name:"Configuration",component:Le},{path:"/indexes",name:"Indexed fields",component:function(){return n.e("indexes").then(n.bind(null,"8c18"))}},{path:"/oai-pmh",name:"OAI-PMH",component:function(){return n.e("oai-pmh").then(n.bind(null,"a905"))}},{path:"/search",name:"Search",component:function(){return n.e("search").then(n.bind(null,"2d3b"))}},{path:"/curl",name:"curl",component:function(){return n.e("curl").then(n.bind(null,"52a2"))}}],Fe=Object(Z["a"])({history:Object(Z["b"])("/preservica-api-demo/"),routes:ze}),He=Fe,We=Object(Re["a"])({state:{config:{proxy:"https://proxy.arjanvanbentem.nl/",host:"https://eu.preservica.com/",username:"",password:"",tenant:""}},mutations:{setConfig:function(e,t){e.config=t}},actions:{},modules:{}}),Me=(n("bddf"),n("4121"),n("098b"),n("e1ae"),Object(r["createApp"])(Q));Me.use(We),Me.use(He),Me.use(T.a,{ripple:!0}),Me.use(I.a),Me.component("Accordion",a.a),Me.component("AccordionTab",i.a),Me.component("Button",s.a),Me.component("Column",f.a),Me.component("ColumnGroup",h.a),Me.component("Checkbox",d.a),Me.component("DataTable",v.a),Me.component("Dropdown",j.a),Me.component("InputText",x.a),Me.component("MultiSelect",w.a),Me.component("Password",k.a),Me.component("Textarea",P.a),Me.component("Toast",S.a),Me.directive("tooltip",D.a),Me.mount("#app")},d0f2:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));n("a4d3"),n("e01a"),n("d3b7");var r=n("7a23"),o=(n("99af"),n("a15b"),n("ddb0"),n("3835")),a=n("b85c"),c=n("5530"),i=(n("96cf"),n("1da1")),u=n("d4ec"),s=n("d36f"),l=6e4,d=function e(){var t=this;Object(u["a"])(this,e),this.toast=Object(s["useToast"])(),this.user=Object(r["ref"])(void 0),this.configured=Object(r["ref"])(!1),this.authorized=Object(r["ref"])(!1),this.lastCurl=Object(r["ref"])(""),this.setConfig=function(e){t.config=e,t.configured.value=!0,t.authorized.value=!1},this.login=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n){var r,o,a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n&&t.setConfig(n),t.authorized.value=!1,r=t.config,o="username=".concat(null===r||void 0===r?void 0:r.username,"&password=").concat(null===r||void 0===r?void 0:r.password,"&tenant=").concat(null===r||void 0===r?void 0:r.tenant,"&includeUserDetails=true"),e.next=6,t.fetchWithDefaults("api/accesstoken/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});case 6:return a=e.sent,e.next=9,a.json();case 9:c=e.sent,t.user.value={user:c.user,fullName:c.fullName,email:c.email,roles:c.roles,token:c.token,refreshToken:c["refresh-token"],validForMinutes:c.validFor,validFrom:Date.now(),validUntil:Date.now()+60*c.validFor*1e3},t.authorized.value=!0,t.toast.add({severity:"success",summary:"Got new token",detail:t.user.value.token,life:2e3});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getToken=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.config){e.next=3;break}throw t.toast.add({severity:"error",summary:"Not configured",detail:"You need to set the configuration first"}),"No credentials set";case 3:if(t.user.value&&!(t.user.value.validUntil-Date.now()<l)){e.next=6;break}return e.next=6,t.login();case 6:if(t.user.value){e.next=8;break}throw"Failed to authenticate";case 8:return e.abrupt("return",t.user.value.token);case 9:case"end":return e.stop()}}),e)}))),this.fetchWithToken=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getToken();case 2:return o=e.sent,e.abrupt("return",t.fetchWithDefaults(n,r,o));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.fullUrl=function(e){var n,r,o,a=(null===(n=t.config)||void 0===n?void 0:n.host)+e;return null!==(r=t.config)&&void 0!==r&&r.proxy?"".concat(null===(o=t.config)||void 0===o?void 0:o.proxy).concat(a):a},this.fetchWithDefaults=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n,r,i){var u,s,l,d,p,f,b,h,m,v,O;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s={headers:{Accept:"application/json"}},l=new Request(t.fullUrl(n),Object(c["a"])(Object(c["a"])(Object(c["a"])({},s),r),{},{headers:Object(c["a"])(Object(c["a"])(Object(c["a"])({},s.headers),null===r||void 0===r?void 0:r.headers),i?{"Preservica-Access-Token":i}:null)})),d=[],p=Object(a["a"])(l.headers.entries());try{for(p.s();!(f=p.n()).done;)b=Object(o["a"])(f.value,2),h=b[0],m=b[1],d.push("-H '".concat(h,": ").concat(m,"'"))}catch(j){p.e(j)}finally{p.f()}return v=null!==r&&void 0!==r&&r.body?" --data '".concat(null===r||void 0===r?void 0:r.body,"'"):"",t.lastCurl.value="curl -v '".concat((null===(u=t.config)||void 0===u?void 0:u.host)+n,"' -X ").concat(l.method," ").concat(d.join(" ")).concat(v),e.next=9,fetch(l).catch((function(e){throw t.toast.add({severity:"error",summary:"Failed to connect to proxy or server",detail:e}),new Error("Failed to connect to proxy or Preservica server")}));case 9:if(O=e.sent,O.ok){e.next=23;break}return e.t0=t.toast,e.t1="Error ".concat(O.status),e.next=15,O.text();case 15:if(e.t2=e.sent,e.t2){e.next=18;break}e.t2=n;case 18:throw e.t3=e.t2,e.t4={severity:"error",summary:e.t1,detail:e.t3,life:3e4},e.t0.add.call(e.t0,e.t4),console.error(O),new Error(O.statusText);case 23:return e.abrupt("return",O);case 24:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},p=Symbol();function f(){Object(r["provide"])(p,new d)}function b(){var e=Object(r["inject"])(p);if(!e)throw Error("plugins/Auth not provided");return e}},da24:function(e,t,n){"use strict";n("f17a")},f17a:function(e,t,n){}});
//# sourceMappingURL=app.cba246ab.js.map